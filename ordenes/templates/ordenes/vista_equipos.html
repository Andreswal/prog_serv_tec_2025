<h3>ðŸ“¦ Equipos en el taller</h3>

<form method="get" class="form-inline mb-3">
  <input type="text" name="cliente" value="{{ cliente }}" class="form-control mr-2" placeholder="Cliente">
  <input type="text" name="marca" value="{{ marca }}" class="form-control mr-2" placeholder="Marca">
  <input type="text" name="modelo" value="{{ modelo }}" class="form-control mr-2" placeholder="Modelo">
  <select name="estado" class="form-control mr-2">
    <option value="">-- Estado --</option>
    <option value="Pendiente" {% if estado == "Pendiente" %}selected{% endif %}>Pendiente</option>
    <option value="Listo" {% if estado == "Listo" %}selected{% endif %}>Listo</option>
    <option value="Entregado" {% if estado == "Entregado" %}selected{% endif %}>Entregado</option>
  </select>
  <button type="submit" class="btn btn-primary">Filtrar</button>
</form>

<table class="table table-striped table-bordered">
  <thead class="thead-dark">
    <tr>
      <th># Orden</th>
      <th>Ingreso</th>
      <th>Marca</th>
      <th>Modelo</th>
      <th>Cliente</th>
      <th>Estado</th>
      <th>Detalle</th>
    </tr>
  </thead>
  <tbody>
    {% for orden in ordenes %}
    <tr>
      <td>{{ orden.id }}</td>
      <td>{{ orden.fecha_ingreso|date:"d/m/Y H:i" }}</td>
      <td>{{ orden.equipo.marca }}</td>
      <td>{{ orden.equipo.modelo }}</td>
      <td>{{ orden.cliente.nombre }}</td>
      <td>{{ orden.estado }}</td>
      <td><button class="btn btn-sm btn-info" onclick="abrirModal({{ orden.id }})">Ver</button>

    </tr>
    {% endfor %}

    <script>
      function abrirModal(ordenId) {
        $('#modalContenido').html('<div class="text-center text-muted">Cargando...</div>');
        $('#modalOrden').modal('show');
        $.get(`/ordenes/detalle/${ordenId}/`, function(data) {
          $('#modalContenido').html(data);
        });
      }
      </script>
      

  </tbody>
</table>

<div class="modal fade" id="modalOrden" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Detalle de Orden</h5>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body" id="modalContenido">
        <div class="text-center text-muted">Cargando...</div>
      </div>
    </div>
  </div>
</div>
